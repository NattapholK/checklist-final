<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô & ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Custom CSS for body and container - using Tailwind for most, but some specifics here */
    body {
      font-family: 'Inter', sans-serif; /* ‡πÉ‡∏ä‡πâ‡∏ü‡∏≠‡∏ô‡∏ï‡πå Inter ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ */
      background-color: #f0f2f5; /* ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏≠‡πà‡∏≠‡∏ô‡πÜ */
      display: flex;
      justify-content: center;
      align-items: flex-start; /* ‡∏à‡∏±‡∏î‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô */
      min-height: 100vh;
      padding: 2rem;
      box-sizing: border-box;
    }

    .container {
      background: white;
      padding: 2.5rem; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å 40px 60px */
      border-radius: 1rem; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å 12px */
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); /* ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏≤ */
      text-align: center;
      width: 100%; /* ‡∏ó‡∏≥‡πÉ‡∏´‡πâ responsive */
      max-width: 600px; /* ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î */
    }

    .school-logo {
      width: 100px;
      height: auto;
      margin-bottom: 1.5rem; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å 20px */
      border-radius: 0.5rem; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å 8px */
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
    }

    h1 {
      color: #333;
      margin-bottom: 1.5rem; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å 20px */
      font-size: 2.25rem; /* Tailwind h1 size */
      font-weight: 700;
    }

    /* Styles for form elements */
    select, button {
      font-size: 1rem;
      padding: 0.75rem; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å 8px */
      margin-top: 0.75rem; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å 10px */
      width: 100%;
      max-width: 300px;
      border-radius: 0.5rem; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏≠‡∏ö‡πÇ‡∏Ñ‡πâ‡∏á */
      border: 1px solid #cbd5e0; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏≠‡∏ö */
    }

    button {
      background-color: #4299e1; /* ‡∏™‡∏µ‡∏ü‡πâ‡∏≤ */
      color: white;
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.2s ease-in-out;
    }

    button[type="submit"]:hover {
      background-color: #3182ce; /* ‡∏™‡∏µ‡∏ü‡πâ‡∏≤‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏Æ‡πÄ‡∏ß‡∏≠‡∏£‡πå */
    }

    button[type="reset"] {
      background-color: #a0aec0; /* ‡∏™‡∏µ‡πÄ‡∏ó‡∏≤ */
    }

    button[type="reset"]:hover {
      background-color: #718096; /* ‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏Æ‡πÄ‡∏ß‡∏≠‡∏£‡πå */
    }

    #result {
      margin-top: 1.5rem; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å 20px */
      font-weight: bold;
      font-size: 1.125rem;
    }

    /* Styles for report list section */
    .report-section {
      margin-top: 3rem; /* ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏ô */
      padding-top: 2rem;
      border-top: 1px solid #e2e8f0; /* ‡πÄ‡∏™‡πâ‡∏ô‡∏Ñ‡∏±‡πà‡∏ô */
    }

    .report-section h2 {
      color: #333;
      margin-bottom: 1.5rem;
      font-size: 1.75rem; /* Tailwind h2 size */
      font-weight: 700;
      text-align: left;
    }

    .report-list ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .report-list li {
      background-color: #edf2f7; /* ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ */
      margin-bottom: 0.75rem;
      padding: 1rem 1.5rem;
      border-radius: 0.75rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: background-color 0.2s ease-in-out, transform 0.2s ease-in-out;
    }

    .report-list li:hover {
      background-color: #e2e8f0;
      transform: translateY(-2px);
    }

    .report-list a {
      color: #2b6cb0;
      text-decoration: none;
      font-weight: 600;
      flex-grow: 1;
      text-align: left;
    }

    .report-list a:hover {
      text-decoration: underline;
    }

    .view-report-button {
      background-color: #4299e1;
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      font-weight: 500;
      transition: background-color 0.2s ease-in-out;
    }

    .view-report-button:hover {
      background-color: #3182ce;
    }
  </style>
</head>
<body>

  <div class="container">
    <img src="/static/ImageDebsirin.png" alt="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏ó‡∏û‡∏®‡∏¥‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå" class="school-logo" />
    <h1>‚úÖ ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°.6/2</h1>

    <!-- Check-in Form Section -->
    <form id="checkin-form">
      <label for="student" class="block text-gray-700 text-sm font-bold mb-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</label>
      <select id="student" required class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
        <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠ (‡∏ñ‡πâ‡∏≤‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏´‡πâ‡∏≤‡∏° submit ‡∏ä‡∏∑‡πà‡∏≠‡∏ã‡πâ‡∏≥) --</option>
        {% for name in students %}
          <option value="{{ loop.index }}|{{ name }}">{{ loop.index }} - {{ name }}</option>
        {% endfor %}
      </select>
      <button type="submit" class="mt-4 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
      <button type="reset" class="mt-2 bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
    </form>

    <div id="result" class="mt-4 text-lg"></div>

    <!-- Attendance Report List Section -->
    <div class="report-section">
        <h2 class="text-2xl">üìã ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á</h2>
        {% if dates %}
        <div class="report-list">
            <ul>
                {% for date in dates %}
                <li>
                    <a href="/report/{{ date }}" class="text-lg">{{ date }}</a>
                    <a href="/report/{{ date }}" class="view-report-button">‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</a>
                </li>
                {% endfor %}
            </ul>
        </div>
        {% else %}
        <p class="text-gray-600">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á</p>
        {% endif %}
    </div>
  </div>

  <script>
    const form = document.getElementById('checkin-form');
    const result = document.getElementById('result');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const selected = document.getElementById('student').value;

      if (!selected.includes('|')) {
        result.textContent = "‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
        result.style.color = "red";
        return;
      }

      const [number, name] = selected.split("|");

      try {
        const res = await fetch("/checkin", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ name, number })
        });

        const data = await res.json();

        if (res.ok) {
          result.textContent = data.message;
          result.style.color = "green";
          form.reset();
          // *** ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á ***
          window.location.reload(); 
        } else {
          result.textContent = data.error;
          result.style.color = "red";
        }

      } catch (err) {
        result.textContent = "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + err.message;
        result.style.color = "red";
      }
    });
  </script>

</body>
</html>
